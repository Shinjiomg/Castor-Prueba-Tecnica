---
import Layout from '../layouts/Layout.astro';
import { spotifyService } from '../lib/spotify';

// Obtener algunos tracks populares para mostrar en la página principal
let topTracks: any[] = [];
try {
  topTracks = await spotifyService.getTopTracks(6);
} catch (error) {
  console.error('Error fetching top tracks:', error);
}
---

<Layout title="MusicApp - Descubre tu música favorita">
  <div class="text-center mb-12">
    <h1 class="text-5xl font-bold bg-gradient-to-r from-green-400 to-blue-400 bg-clip-text text-transparent mb-4">
      Descubre tu música favorita
    </h1>
    <p class="text-xl text-gray-300 mb-8 max-w-2xl mx-auto">
      Explora millones de canciones, álbumes y artistas con Spotify. 
      Tu música, tu estilo, tu experiencia.
    </p>
    <div class="flex justify-center space-x-4">
      <a 
        href="/search" 
        class="bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 text-white px-8 py-4 rounded-xl font-medium transition-all duration-200 shadow-lg hover:shadow-green-500/25 transform hover:scale-105"
      >
        Buscar música
      </a>
      <a 
        href="/register" 
        class="bg-gray-800 hover:bg-gray-700 text-white px-8 py-4 rounded-xl font-medium transition-all duration-200 border border-gray-700 hover:border-gray-600"
      >
        Registrarse
      </a>
    </div>
  </div>

  {topTracks.length > 0 && (
    <section class="mb-12">
      <h2 class="text-3xl font-bold text-white mb-8 text-center">Nuevos lanzamientos</h2>
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
        {topTracks.map((track) => (
          <div class="bg-gray-800 rounded-xl shadow-lg overflow-hidden hover:shadow-2xl transition-all duration-300 transform hover:scale-105 border border-gray-700">
            <div class="aspect-square bg-gray-700 relative overflow-hidden">
              {track.album.images[0] ? (
                <img 
                  src={track.album.images[0].url} 
                  alt={track.name}
                  class="w-full h-full object-cover transition-transform duration-300 hover:scale-110"
                />
              ) : (
                <div class="w-full h-full flex items-center justify-center text-gray-400">
                  <svg class="w-16 h-16" fill="currentColor" viewBox="0 0 24 24">
                    <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
                  </svg>
                </div>
              )}
              <div class="absolute inset-0 bg-gradient-to-t from-black/60 to-transparent opacity-0 hover:opacity-100 transition-opacity duration-300"></div>
            </div>
            <div class="p-6">
              <h3 class="font-semibold text-white mb-2 truncate text-lg">{track.name}</h3>
              <p class="text-sm text-gray-300 mb-2">
                {track.artists.map((artist: any) => artist.name).join(', ')}
              </p>
              <p class="text-xs text-gray-400">{track.album.name}</p>
            </div>
          </div>
        ))}
      </div>
    </section>
  )}

  <section class="grid grid-cols-1 md:grid-cols-3 gap-8">
    <div class="text-center group">
      <div class="w-20 h-20 bg-gradient-to-br from-green-400 to-green-600 rounded-2xl flex items-center justify-center mx-auto mb-6 shadow-lg group-hover:shadow-green-500/25 transition-all duration-300 transform group-hover:scale-110">
        <svg class="w-10 h-10 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
        </svg>
      </div>
      <h3 class="text-xl font-semibold text-white mb-3">Busca música</h3>
      <p class="text-gray-300">Encuentra canciones, álbumes y artistas de todo el mundo</p>
    </div>
    
    <div class="text-center group">
      <div class="w-20 h-20 bg-gradient-to-br from-blue-400 to-blue-600 rounded-2xl flex items-center justify-center mx-auto mb-6 shadow-lg group-hover:shadow-blue-500/25 transition-all duration-300 transform group-hover:scale-110">
        <svg class="w-10 h-10 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"></path>
        </svg>
      </div>
      <h3 class="text-xl font-semibold text-white mb-3">Guarda favoritos</h3>
      <p class="text-gray-300">Crea tu colección personal de música favorita</p>
    </div>
    
    <div class="text-center group">
      <div class="w-20 h-20 bg-gradient-to-br from-purple-400 to-purple-600 rounded-2xl flex items-center justify-center mx-auto mb-6 shadow-lg group-hover:shadow-purple-500/25 transition-all duration-300 transform group-hover:scale-110">
        <svg class="w-10 h-10 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.536 8.464a5 5 0 010 7.072m2.828-9.9a9 9 0 010 12.728M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z"></path>
        </svg>
      </div>
      <h3 class="text-xl font-semibold text-white mb-3">Escucha previews</h3>
      <p class="text-gray-300">Disfruta de fragmentos de canciones antes de decidir</p>
    </div>
  </section>
</Layout>
